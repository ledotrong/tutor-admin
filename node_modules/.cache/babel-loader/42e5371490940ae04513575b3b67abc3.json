{"ast":null,"code":"import\"antd/es/modal/style\";import _Modal from\"antd/es/modal\";import\"antd/es/form/style\";import _Form from\"antd/es/form\";import\"antd/es/input/style\";import _Input from\"antd/es/input\";import\"antd/es/upload/style\";import _Upload from\"antd/es/upload\";import\"antd/es/button/style\";import _Button from\"antd/es/button\";import\"antd/es/icon/style\";import _Icon from\"antd/es/icon\";import _regeneratorRuntime from\"/Users/trongledo/Documents/GitHub/tutor-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _defineProperty from\"/Users/trongledo/Documents/GitHub/tutor-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/Users/trongledo/Documents/GitHub/tutor-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/trongledo/Documents/GitHub/tutor-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/trongledo/Documents/GitHub/tutor-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/trongledo/Documents/GitHub/tutor-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"/Users/trongledo/Documents/GitHub/tutor-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/trongledo/Documents/GitHub/tutor-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import\"antd/es/message/style\";import _message from\"antd/es/message\";import\"antd/es/select/style\";import _Select from\"antd/es/select\";import React,{Component}from'react';import{storage}from'../../helpers/Firebase';var Option=_Select.Option;_message.config({top:70});var AddModal=/*#__PURE__*/function(_Component){_inherits(AddModal,_Component);function AddModal(props){var _this;_classCallCheck(this,AddModal);_this=_possibleConstructorReturn(this,_getPrototypeOf(AddModal).call(this,props));_this.state={token:null,loading:false,role:'admin',name:'',email:'',imageFile:null,imageURL:null,picture:null,address:'',password:''};_this.onChangeHandler=_this.onChangeHandler.bind(_assertThisInitialized(_this));_this.onSubmit=_this.onSubmit.bind(_assertThisInitialized(_this));_this.handleUpload=_this.handleUpload.bind(_assertThisInitialized(_this));return _this;}_createClass(AddModal,[{key:\"componentDidMount\",value:function componentDidMount(){var token=JSON.parse(localStorage.getItem('token'));if(token)this.setState({token:token});}},{key:\"onChangeHandler\",value:function onChangeHandler(e){this.setState(_defineProperty({},e.target.name,e.target.value));}},{key:\"onRoleChange\",value:function onRoleChange(role){this.setState({role:role});}},{key:\"beforeUpload\",value:function beforeUpload(file){var isJpgOrPng=file.type==='image/jpeg'||file.type==='image/png';if(!isJpgOrPng){_message.error('You can only upload JPG/PNG file!');}var isLt2M=file.size/1024/1024<2;if(!isLt2M){_message.error('Image must smaller than 2MB!');}return isJpgOrPng&&isLt2M;}},{key:\"handleResponse\",value:function handleResponse(response){return response.text().then(function(text){var data=text&&JSON.parse(text);if(!response.ok){return data;}return data;});}},{key:\"handleUpload\",value:function handleUpload(info){var _this2=this;if(info.file.status==='uploading'){this.setState({loading:true});return;}if(info.file.status==='done'){// Get this url from response in real world.\nthis.getBase64(info.file.originFileObj,function(imageURL){return _this2.setState({imageURL:imageURL,imageFile:info.file.originFileObj,loading:false});});}}},{key:\"getBase64\",value:function getBase64(img,callback){var reader=new FileReader();reader.addEventListener('load',function(){return callback(reader.result);});reader.readAsDataURL(img);}},{key:\"onSubmit\",value:function onSubmit(e){var _this3=this;var imageFile,uploadImage;return _regeneratorRuntime.async(function onSubmit$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();this.setState({loading:true});imageFile=this.state.imageFile;if(imageFile){uploadImage=storage.ref(\"images/\".concat(imageFile.name)).put(imageFile);uploadImage.on('state_changed',function(){// console.log(snapshot);\n},function(error){console.log(error);},function _callee(){var imageURL;return _regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _regeneratorRuntime.awrap(storage.ref('images').child(imageFile.name).getDownloadURL());case 2:imageURL=_context.sent;_this3.setState({picture:imageURL});_this3.sendRequest(imageURL);case 5:case\"end\":return _context.stop();}}});});}else this.sendRequest(null);case 4:case\"end\":return _context2.stop();}}},null,this);}},{key:\"sendRequest\",value:function sendRequest(image){var requestOptions,response,data;return _regeneratorRuntime.async(function sendRequest$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:requestOptions={method:'POST',headers:{'Content-Type':'application/json',Authorization:\"Bearer \".concat(this.state.token)},body:JSON.stringify({name:this.state.name,email:this.state.email,password:this.state.password,address:this.state.address,role:this.state.role,picture:image?image:undefined})};_context3.prev=1;_context3.next=4;return _regeneratorRuntime.awrap(fetch('https://cors-anywhere.herokuapp.com/https://admin-api-tutor.herokuapp.com/user/register',requestOptions));case 4:response=_context3.sent;_context3.next=7;return _regeneratorRuntime.awrap(this.handleResponse(response));case 7:data=_context3.sent;if(data.newUser){_message.success('Account created successfully');this.props.handleSubmit();}else _message.error(data);this.setState({loading:false});_context3.next=15;break;case 12:_context3.prev=12;_context3.t0=_context3[\"catch\"](1);console.log(_context3.t0);case 15:case\"end\":return _context3.stop();}}},null,this,[[1,12]]);}},{key:\"render\",value:function render(){var _this4=this;var modalVisible=this.props.modalVisible;var formItemLayout={labelCol:{xs:{span:18},sm:{span:5}},wrapperCol:{xs:{span:28},sm:{span:17}}};var uploadButton=React.createElement(\"div\",null,React.createElement(_Icon,{type:this.state.loading?'loading':'plus'}),React.createElement(\"div\",{className:\"ant-upload-text\"},\"Upload\"));return React.createElement(\"div\",null,React.createElement(_Form,Object.assign({},formItemLayout,{onSubmit:this.handleSubmit}),React.createElement(_Modal,{title:\"Create New Account\",visible:modalVisible,onOk:function onOk(){return _this4.onSubmit();},onCancel:this.props.handleCancel,footer:[React.createElement(_Button,{onClick:this.props.handleCancel},\"Cancel\"),React.createElement(_Button,{key:\"Submit\",loading:this.state.loading,type:\"primary\",onClick:this.onSubmit},\"Submit\")]},React.createElement(_Upload,{name:\"avatar\",listType:\"picture-card\",className:\"avatar-uploader d-flex justify-content-center mb-2\",showUploadList:false,action:\"https://www.mocky.io/v2/5cc8019d300000980a055e76\",beforeUpload:this.beforeUpload,onChange:this.handleUpload},this.state.imageURL?React.createElement(\"img\",{src:this.state.imageURL,alt:\"avatar\",style:{width:'100%'}}):uploadButton),React.createElement(_Form.Item,{label:\"Name\"},React.createElement(_Input,{name:\"name\",required:true,placeholder:\"your full name\",onChange:this.onChangeHandler})),React.createElement(_Form.Item,{label:\"E-mail\"},React.createElement(_Input,{name:\"email\",required:true,placeholder:\"example@email\",onChange:this.onChangeHandler})),React.createElement(_Form.Item,{label:\"Password\"},React.createElement(_Input.Password,{name:\"password\",placeholder:\"at least 6 characters\",onChange:this.onChangeHandler})),React.createElement(_Form.Item,{label:\"Address\"},React.createElement(_Input,{name:\"address\",required:true,placeholder:\"Eg: 123 Street, Ward,...\",onChange:this.onChangeHandler})),React.createElement(_Form.Item,{label:\"Role\"},React.createElement(_Select,{value:this.state.role,size:this.props.size,style:{width:'32%'},onChange:function onChange(value){return _this4.onRoleChange(value);}},React.createElement(Option,{value:\"admin\"},\"Admin\"),React.createElement(Option,{value:\"master\"},\"Master\"))))));}}]);return AddModal;}(Component);export default AddModal;","map":{"version":3,"sources":["/Users/trongledo/Documents/GitHub/tutor-admin/src/views/Accounts/AddModal.js"],"names":["React","Component","storage","Option","config","top","AddModal","props","state","token","loading","role","name","email","imageFile","imageURL","picture","address","password","onChangeHandler","bind","onSubmit","handleUpload","JSON","parse","localStorage","getItem","setState","e","target","value","file","isJpgOrPng","type","error","isLt2M","size","response","text","then","data","ok","info","status","getBase64","originFileObj","img","callback","reader","FileReader","addEventListener","result","readAsDataURL","preventDefault","uploadImage","ref","put","on","console","log","child","getDownloadURL","sendRequest","image","requestOptions","method","headers","Authorization","body","stringify","undefined","fetch","handleResponse","newUser","success","handleSubmit","modalVisible","formItemLayout","labelCol","xs","span","sm","wrapperCol","uploadButton","handleCancel","beforeUpload","width","onRoleChange"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport {\n  message,\n  Upload,\n  Button,\n  Modal,\n  Form,\n  Input,\n  Select,\n  Icon\n} from 'antd';\nimport { storage } from '../../helpers/Firebase';\n\nconst { Option } = Select;\nmessage.config({\n  top: 70\n});\n\nclass AddModal extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      token: null,\n      loading: false,\n      role: 'admin',\n      name: '',\n      email: '',\n      imageFile: null,\n      imageURL: null,\n      picture: null,\n      address: '',\n      password: ''\n    };\n\n    this.onChangeHandler = this.onChangeHandler.bind(this);\n    this.onSubmit = this.onSubmit.bind(this);\n    this.handleUpload = this.handleUpload.bind(this);\n  }\n\n  componentDidMount() {\n    const token = JSON.parse(localStorage.getItem('token'));\n    if (token) this.setState({ token });\n  }\n\n  onChangeHandler(e) {\n    this.setState({ [e.target.name]: e.target.value });\n  }\n\n  onRoleChange(role) {\n    this.setState({ role });\n  }\n\n  beforeUpload(file) {\n    const isJpgOrPng = file.type === 'image/jpeg' || file.type === 'image/png';\n    if (!isJpgOrPng) {\n      message.error('You can only upload JPG/PNG file!');\n    }\n    const isLt2M = file.size / 1024 / 1024 < 2;\n    if (!isLt2M) {\n      message.error('Image must smaller than 2MB!');\n    }\n    return isJpgOrPng && isLt2M;\n  }\n\n  handleResponse(response) {\n    return response.text().then(text => {\n      const data = text && JSON.parse(text);\n      if (!response.ok) {\n        return data;\n      }\n      return data;\n    });\n  }\n\n  handleUpload(info) {\n    if (info.file.status === 'uploading') {\n      this.setState({ loading: true });\n      return;\n    }\n    if (info.file.status === 'done') {\n      // Get this url from response in real world.\n      this.getBase64(info.file.originFileObj, imageURL =>\n        this.setState({\n          imageURL,\n          imageFile: info.file.originFileObj,\n          loading: false\n        })\n      );\n    }\n  }\n\n  getBase64(img, callback) {\n    const reader = new FileReader();\n    reader.addEventListener('load', () => callback(reader.result));\n    reader.readAsDataURL(img);\n  }\n\n  async onSubmit(e) {\n    e.preventDefault();\n    this.setState({ loading: true });\n\n    const { imageFile } = this.state;\n    if (imageFile) {\n      const uploadImage = storage\n        .ref(`images/${imageFile.name}`)\n        .put(imageFile);\n      uploadImage.on(\n        'state_changed',\n        () => {\n          // console.log(snapshot);\n        },\n        error => {\n          console.log(error);\n        },\n        async () => {\n          const imageURL = await storage\n            .ref('images')\n            .child(imageFile.name)\n            .getDownloadURL();\n          this.setState({ picture: imageURL });\n          this.sendRequest(imageURL);\n        }\n      );\n    } else this.sendRequest(null);\n  }\n\n  async sendRequest(image) {\n    const requestOptions = {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: `Bearer ${this.state.token}`\n      },\n      body: JSON.stringify({\n        name: this.state.name,\n        email: this.state.email,\n        password: this.state.password,\n        address: this.state.address,\n        role: this.state.role,\n        picture: image ? image : undefined\n      })\n    };\n    try {\n      const response = await fetch(\n        'https://cors-anywhere.herokuapp.com/https://admin-api-tutor.herokuapp.com/user/register',\n        requestOptions\n      );\n\n      let data = await this.handleResponse(response);\n      if (data.newUser) {\n        message.success('Account created successfully');\n        this.props.handleSubmit();\n      } else message.error(data);\n\n      this.setState({ loading: false });\n    } catch (err) {\n      console.log(err);\n    }\n  }\n\n  render() {\n    const modalVisible = this.props.modalVisible;\n    const formItemLayout = {\n      labelCol: {\n        xs: { span: 18 },\n        sm: { span: 5 }\n      },\n      wrapperCol: {\n        xs: { span: 28 },\n        sm: { span: 17 }\n      }\n    };\n    const uploadButton = (\n      <div>\n        <Icon type={this.state.loading ? 'loading' : 'plus'} />\n        <div className=\"ant-upload-text\">Upload</div>\n      </div>\n    );\n\n    return (\n      <div>\n        <Form {...formItemLayout} onSubmit={this.handleSubmit}>\n          <Modal\n            title=\"Create New Account\"\n            visible={modalVisible}\n            onOk={() => this.onSubmit()}\n            onCancel={this.props.handleCancel}\n            footer={[\n              <Button onClick={this.props.handleCancel}>Cancel</Button>,\n              <Button\n                key=\"Submit\"\n                loading={this.state.loading}\n                type=\"primary\"\n                onClick={this.onSubmit}\n              >\n                Submit\n              </Button>\n            ]}\n          >\n            <Upload\n              name=\"avatar\"\n              listType=\"picture-card\"\n              className=\"avatar-uploader d-flex justify-content-center mb-2\"\n              showUploadList={false}\n              action=\"https://www.mocky.io/v2/5cc8019d300000980a055e76\"\n              beforeUpload={this.beforeUpload}\n              onChange={this.handleUpload}\n            >\n              {this.state.imageURL ? (\n                <img\n                  src={this.state.imageURL}\n                  alt=\"avatar\"\n                  style={{ width: '100%' }}\n                />\n              ) : (\n                uploadButton\n              )}\n            </Upload>\n            <Form.Item label=\"Name\">\n              <Input\n                name=\"name\"\n                required\n                placeholder=\"your full name\"\n                onChange={this.onChangeHandler}\n              />\n            </Form.Item>\n            <Form.Item label=\"E-mail\">\n              <Input\n                name=\"email\"\n                required\n                placeholder=\"example@email\"\n                onChange={this.onChangeHandler}\n              />\n            </Form.Item>\n            <Form.Item label=\"Password\">\n              <Input.Password\n                name=\"password\"\n                placeholder=\"at least 6 characters\"\n                onChange={this.onChangeHandler}\n              />\n            </Form.Item>\n            <Form.Item label=\"Address\">\n              <Input\n                name=\"address\"\n                required\n                placeholder=\"Eg: 123 Street, Ward,...\"\n                onChange={this.onChangeHandler}\n              />\n            </Form.Item>\n            <Form.Item label=\"Role\">\n              <Select\n                value={this.state.role}\n                size={this.props.size}\n                style={{ width: '32%' }}\n                onChange={value => this.onRoleChange(value)}\n              >\n                <Option value=\"admin\">Admin</Option>\n                <Option value=\"master\">Master</Option>\n              </Select>\n            </Form.Item>\n          </Modal>\n        </Form>\n      </div>\n    );\n  }\n}\n\nexport default AddModal;\n"]},"metadata":{},"sourceType":"module"}