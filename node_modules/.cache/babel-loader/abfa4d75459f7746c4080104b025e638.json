{"ast":null,"code":"import\"antd/es/form/style\";import _Form from\"antd/es/form\";import\"antd/es/modal/style\";import _Modal from\"antd/es/modal\";import\"antd/es/button/style\";import _Button from\"antd/es/button\";import _regeneratorRuntime from\"/Users/trongledo/Documents/GitHub/tutor-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import\"antd/es/message/style\";import _message from\"antd/es/message\";import _defineProperty from\"/Users/trongledo/Documents/GitHub/tutor-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/Users/trongledo/Documents/GitHub/tutor-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/trongledo/Documents/GitHub/tutor-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/trongledo/Documents/GitHub/tutor-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/trongledo/Documents/GitHub/tutor-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"/Users/trongledo/Documents/GitHub/tutor-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/trongledo/Documents/GitHub/tutor-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';var DeleteModal=/*#__PURE__*/function(_Component){_inherits(DeleteModal,_Component);function DeleteModal(props){var _this;_classCallCheck(this,DeleteModal);_this=_possibleConstructorReturn(this,_getPrototypeOf(DeleteModal).call(this,props));_this.state={token:null,loading:false,role:'admin',name:'',email:'',imageFile:null,imageURL:null,picture:null,address:'',password:''};_this.onChangeHandler=_this.onChangeHandler.bind(_assertThisInitialized(_this));_this.onSubmit=_this.onSubmit.bind(_assertThisInitialized(_this));return _this;}_createClass(DeleteModal,[{key:\"componentDidMount\",value:function componentDidMount(){var token=JSON.parse(localStorage.getItem('token'));var currentUser=this.props.currentUser;if(token)this.setState({token:token});this.setState({name:currentUser.name,email:currentUser.email,address:currentUser.address,role:currentUser.role});}},{key:\"onChangeHandler\",value:function onChangeHandler(e){this.setState(_defineProperty({},e.target.name,e.target.value));}},{key:\"handleResponse\",value:function handleResponse(response){return response.text().then(function(text){var data=text&&JSON.parse(text);if(!response.ok){return data;}return data;});}},{key:\"onSubmit\",value:function onSubmit(e){var requestOptions,response,data;return _regeneratorRuntime.async(function onSubmit$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();this.setState({loading:true});requestOptions={method:'DELETE',headers:{'Content-Type':'application/json',Authorization:\"Bearer \".concat(this.state.token)},body:JSON.stringify({_id:this.props.currentUser._id})};_context.prev=3;_context.next=6;return _regeneratorRuntime.awrap(fetch('https://cors-anywhere.herokuapp.com/https://admin-api-tutor.herokuapp.com/me/deleteUser',requestOptions));case 6:response=_context.sent;_context.next=9;return _regeneratorRuntime.awrap(this.handleResponse(response));case 9:data=_context.sent;if(data.deleted){_message.success('Account deleted successfully');this.props.handleSubmit();}else _message.error(data);this.setState({loading:false});_context.next=17;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](3);console.log(_context.t0);case 17:case\"end\":return _context.stop();}}},null,this,[[3,14]]);}},{key:\"render\",value:function render(){var _this2=this;var modalVisible=this.props.modalVisible;var formItemLayout={labelCol:{xs:{span:18},sm:{span:5}},wrapperCol:{xs:{span:28},sm:{span:17}}};return React.createElement(\"div\",null,React.createElement(_Form,Object.assign({},formItemLayout,{onSubmit:this.handleSubmit}),React.createElement(_Modal,{title:\"Edit user with ID: \".concat(this.props.currentUser?this.props.currentUser._id:null),visible:modalVisible,onOk:function onOk(){return _this2.onSubmit();},onCancel:this.props.handleCancel,footer:[React.createElement(_Button,{onClick:this.props.handleCancel},\"Cancel\"),React.createElement(_Button,{key:\"Submit\",loading:this.state.loading,type:\"danger\",onClick:this.onSubmit},\"Delete\")]},React.createElement(\"p\",null,\"Are you sure to delete this account? (ID:\",' ',this.props.currentUser?this.props.currentUser._id:null,\")\"))));}}]);return DeleteModal;}(Component);export default DeleteModal;","map":{"version":3,"sources":["/Users/trongledo/Documents/GitHub/tutor-admin/src/views/Accounts/DeleteModal.js"],"names":["React","Component","DeleteModal","props","state","token","loading","role","name","email","imageFile","imageURL","picture","address","password","onChangeHandler","bind","onSubmit","JSON","parse","localStorage","getItem","currentUser","setState","e","target","value","response","text","then","data","ok","preventDefault","requestOptions","method","headers","Authorization","body","stringify","_id","fetch","handleResponse","deleted","success","handleSubmit","error","console","log","modalVisible","formItemLayout","labelCol","xs","span","sm","wrapperCol","handleCancel"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { message, Button, Modal, Form } from 'antd';\n\nclass DeleteModal extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      token: null,\n      loading: false,\n      role: 'admin',\n      name: '',\n      email: '',\n      imageFile: null,\n      imageURL: null,\n      picture: null,\n      address: '',\n      password: ''\n    };\n\n    this.onChangeHandler = this.onChangeHandler.bind(this);\n    this.onSubmit = this.onSubmit.bind(this);\n  }\n\n  componentDidMount() {\n    const token = JSON.parse(localStorage.getItem('token'));\n    const currentUser = this.props.currentUser;\n    if (token) this.setState({ token });\n\n    this.setState({\n      name: currentUser.name,\n      email: currentUser.email,\n      address: currentUser.address,\n      role: currentUser.role\n    });\n  }\n\n  onChangeHandler(e) {\n    this.setState({ [e.target.name]: e.target.value });\n  }\n\n  handleResponse(response) {\n    return response.text().then(text => {\n      const data = text && JSON.parse(text);\n      if (!response.ok) {\n        return data;\n      }\n      return data;\n    });\n  }\n\n  async onSubmit(e) {\n    e.preventDefault();\n    this.setState({ loading: true });\n    const requestOptions = {\n      method: 'DELETE',\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: `Bearer ${this.state.token}`\n      },\n      body: JSON.stringify({\n        _id: this.props.currentUser._id\n      })\n    };\n    try {\n      const response = await fetch(\n        'https://cors-anywhere.herokuapp.com/https://admin-api-tutor.herokuapp.com/me/deleteUser',\n        requestOptions\n      );\n      let data = await this.handleResponse(response);\n      if (data.deleted) {\n        message.success('Account deleted successfully');\n        this.props.handleSubmit();\n      } else message.error(data);\n\n      this.setState({ loading: false });\n    } catch (err) {\n      console.log(err);\n    }\n  }\n\n  render() {\n    const modalVisible = this.props.modalVisible;\n    const formItemLayout = {\n      labelCol: {\n        xs: { span: 18 },\n        sm: { span: 5 }\n      },\n      wrapperCol: {\n        xs: { span: 28 },\n        sm: { span: 17 }\n      }\n    };\n\n    return (\n      <div>\n        <Form {...formItemLayout} onSubmit={this.handleSubmit}>\n          <Modal\n            title={`Edit user with ID: ${\n              this.props.currentUser ? this.props.currentUser._id : null\n            }`}\n            visible={modalVisible}\n            onOk={() => this.onSubmit()}\n            onCancel={this.props.handleCancel}\n            footer={[\n              <Button onClick={this.props.handleCancel}>Cancel</Button>,\n              <Button\n                key=\"Submit\"\n                loading={this.state.loading}\n                type=\"danger\"\n                onClick={this.onSubmit}\n              >\n                Delete\n              </Button>\n            ]}\n          >\n            <p>\n              Are you sure to delete this account? (ID:{' '}\n              {this.props.currentUser ? this.props.currentUser._id : null})\n            </p>\n          </Modal>\n        </Form>\n      </div>\n    );\n  }\n}\n\nexport default DeleteModal;\n"]},"metadata":{},"sourceType":"module"}