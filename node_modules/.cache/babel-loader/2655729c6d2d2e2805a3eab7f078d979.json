{"ast":null,"code":"import _objectSpread from\"/Users/trongledo/Documents/GitHub/tutor-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _defineProperty from\"/Users/trongledo/Documents/GitHub/tutor-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"/Users/trongledo/Documents/GitHub/tutor-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _classCallCheck from\"/Users/trongledo/Documents/GitHub/tutor-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/trongledo/Documents/GitHub/tutor-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/trongledo/Documents/GitHub/tutor-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/trongledo/Documents/GitHub/tutor-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"/Users/trongledo/Documents/GitHub/tutor-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/trongledo/Documents/GitHub/tutor-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import{Link}from'react-router-dom';import LoadingOverlay from'react-loading-overlay';import{Button,Card,CardBody,CardGroup,Col,Container,Form,Input,InputGroup,InputGroupAddon,InputGroupText,Row,Alert}from'reactstrap';var Login=/*#__PURE__*/function(_Component){_inherits(Login,_Component);function Login(props){var _this;_classCallCheck(this,Login);_this=_possibleConstructorReturn(this,_getPrototypeOf(Login).call(this,props));_this.onSubmitHandler=function _callee(e){return _regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();_this.setState({loading:true});_this.login(_this.state.email,_this.state.password);case 3:case\"end\":return _context.stop();}}});};_this.login=function _callee2(email,password){var requestOptions,response,userData,role,user;return _regeneratorRuntime.async(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:requestOptions={method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email:email,password:password})};_context2.prev=1;_context2.next=4;return _regeneratorRuntime.awrap(fetch(\"https://admin-api-tutor.herokuapp.com/user/admin-login\",requestOptions));case 4:response=_context2.sent;_context2.next=7;return _regeneratorRuntime.awrap(_this.handleResponse(response));case 7:userData=_context2.sent;if(userData.token){// localStorage.setItem(\"user\", JSON.stringify(userData));\nlocalStorage.setItem('token',JSON.stringify(userData.token));role=userData.user.role;localStorage.setItem('role',role);user=userData.user;localStorage.setItem('user',JSON.stringify(user));_this.props.history.push('/');}_this.setState({loading:false,response:userData});return _context2.abrupt(\"return\",userData);case 13:_context2.prev=13;_context2.t0=_context2[\"catch\"](1);return _context2.abrupt(\"return\",_context2.t0);case 16:case\"end\":return _context2.stop();}}},null,null,[[1,13]]);};_this.state={email:'',password:'',loading:false,response:null};_this.onChangeHandler=_this.onChangeHandler.bind(_assertThisInitialized(_this));_this.onSubmitHandler=_this.onSubmitHandler.bind(_assertThisInitialized(_this));return _this;}_createClass(Login,[{key:\"componentDidMount\",value:function componentDidMount(){var token=JSON.parse(localStorage.getItem('token'));if(token){this.props.history.push('/');}}},{key:\"onChangeHandler\",value:function onChangeHandler(e){this.setState(_defineProperty({},e.target.name,e.target.value));}},{key:\"handleResponse\",value:function handleResponse(response){return response.text().then(function(text){var data=text&&JSON.parse(text);if(!response.ok){if(response.status===401){}// auto logout if 401 response returned from api\n// logoutUser();\n// const error = (data && data.message) || response.statusText;\n// return Promise.reject(error);\nreturn data;}return data;});}},{key:\"render\",value:function render(){return React.createElement(\"div\",{className:\"app flex-row align-items-center\"},React.createElement(Container,null,React.createElement(Row,{className:\"justify-content-center\"},React.createElement(Col,{md:\"8\"},React.createElement(CardGroup,null,React.createElement(Card,{className:\"p-4\"},React.createElement(CardBody,null,React.createElement(LoadingOverlay,{active:this.state.loading,spinner:true,text:\"Loading...\",styles:{overlay:function overlay(base){return _objectSpread({},base,{background:'rgba(255, 255, 255, 0.5)',color:'black'});},spinner:function spinner(base){return _objectSpread({},base,{width:'100px','& svg circle':{stroke:'rgba(255, 0, 0, 0.5)'}});}}},React.createElement(Form,{onSubmit:this.onSubmitHandler},React.createElement(\"h1\",null,\"Login\"),React.createElement(\"p\",{className:\"text-muted\"},\"Sign In to your account\"),React.createElement(InputGroup,{className:\"mb-3\"},React.createElement(InputGroupAddon,{addonType:\"prepend\"},React.createElement(InputGroupText,null,React.createElement(\"i\",{className:\"icon-user\"}))),React.createElement(Input,{type:\"email\",name:\"email\",placeholder:\"Username\",autoComplete:\"email\",required:true,onChange:this.onChangeHandler})),React.createElement(InputGroup,{className:\"mb-4\"},React.createElement(InputGroupAddon,{addonType:\"prepend\"},React.createElement(InputGroupText,null,React.createElement(\"i\",{className:\"icon-lock\"}))),React.createElement(Input,{type:\"password\",name:\"password\",id:\"passwordInput\",required:true,placeholder:\"Password\",autoComplete:\"current-password\",onChange:this.onChangeHandler})),React.createElement(Alert,{id:\"alert\",isOpen:this.state.response,className:\"mt-2 font-weight-light\",color:\"danger\"},this.state.response?this.state.response.message:'hidden'),React.createElement(Row,null,React.createElement(Col,{xs:\"6\"},React.createElement(Button,{type:\"submit\",color:\"primary\",className:\"px-4\"},\"Login\")),React.createElement(Col,{xs:\"6\",className:\"text-right\"},React.createElement(Button,{color:\"link\",className:\"px-0\"},\"Forgot password?\"))))))),React.createElement(Card,{className:\"text-white bg-primary py-5 d-md-down-none\",style:{width:'44%'}},React.createElement(CardBody,{className:\"text-center\"},React.createElement(\"div\",null,React.createElement(\"h2\",null,\"Sign up\"),React.createElement(\"p\",null,\"Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.\"),React.createElement(Link,null,React.createElement(Button,{color:\"primary\",className:\"mt-3\",active:true,tabIndex:-1},\"Register Now!\"))))))))));}}]);return Login;}(Component);export default Login;","map":{"version":3,"sources":["/Users/trongledo/Documents/GitHub/tutor-admin/src/views/Pages/Login/Login.js"],"names":["React","Component","Link","LoadingOverlay","Button","Card","CardBody","CardGroup","Col","Container","Form","Input","InputGroup","InputGroupAddon","InputGroupText","Row","Alert","Login","props","onSubmitHandler","e","preventDefault","setState","loading","login","state","email","password","requestOptions","method","headers","body","JSON","stringify","fetch","response","handleResponse","userData","token","localStorage","setItem","role","user","history","push","onChangeHandler","bind","parse","getItem","target","name","value","text","then","data","ok","status","overlay","base","background","color","spinner","width","stroke","message"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport LoadingOverlay from 'react-loading-overlay';\nimport {\n  Button,\n  Card,\n  CardBody,\n  CardGroup,\n  Col,\n  Container,\n  Form,\n  Input,\n  InputGroup,\n  InputGroupAddon,\n  InputGroupText,\n  Row,\n  Alert\n} from 'reactstrap';\n\nclass Login extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      email: '',\n      password: '',\n      loading: false,\n      response: null\n    };\n\n    this.onChangeHandler = this.onChangeHandler.bind(this);\n    this.onSubmitHandler = this.onSubmitHandler.bind(this);\n  }\n\n  componentDidMount() {\n    const token = JSON.parse(localStorage.getItem('token'));\n\n    if (token) {\n      this.props.history.push('/');\n    }\n  }\n\n  onChangeHandler(e) {\n    this.setState({ [e.target.name]: e.target.value });\n  }\n\n  onSubmitHandler = async e => {\n    e.preventDefault();\n    this.setState({ loading: true });\n    this.login(this.state.email, this.state.password);\n  };\n\n  login = async (email, password) => {\n    const requestOptions = {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({ email, password })\n    };\n    try {\n      const response = await fetch(\n        `https://admin-api-tutor.herokuapp.com/user/admin-login`,\n        requestOptions\n      );\n\n      const userData = await this.handleResponse(response);\n\n      if (userData.token) {\n        // localStorage.setItem(\"user\", JSON.stringify(userData));\n        localStorage.setItem('token', JSON.stringify(userData.token));\n        const role = userData.user.role;\n        localStorage.setItem('role', role);\n        const user = userData.user;\n        localStorage.setItem('user', JSON.stringify(user));\n        this.props.history.push('/');\n      }\n\n      this.setState({ loading: false, response: userData });\n\n      return userData;\n    } catch (err) {\n      return err;\n    }\n  };\n\n  handleResponse(response) {\n    return response.text().then(text => {\n      const data = text && JSON.parse(text);\n      if (!response.ok) {\n        if (response.status === 401) {\n          // auto logout if 401 response returned from api\n          // logoutUser();\n        }\n\n        // const error = (data && data.message) || response.statusText;\n        // return Promise.reject(error);\n        return data;\n      }\n      return data;\n    });\n  }\n\n  render() {\n    return (\n      <div className=\"app flex-row align-items-center\">\n        <Container>\n          <Row className=\"justify-content-center\">\n            <Col md=\"8\">\n              <CardGroup>\n                <Card className=\"p-4\">\n                  <CardBody>\n                    <LoadingOverlay\n                      active={this.state.loading}\n                      spinner\n                      text=\"Loading...\"\n                      styles={{\n                        overlay: base => ({\n                          ...base,\n                          background: 'rgba(255, 255, 255, 0.5)',\n                          color: 'black'\n                        }),\n                        spinner: base => ({\n                          ...base,\n                          width: '100px',\n                          '& svg circle': {\n                            stroke: 'rgba(255, 0, 0, 0.5)'\n                          }\n                        })\n                      }}\n                    >\n                      <Form onSubmit={this.onSubmitHandler}>\n                        <h1>Login</h1>\n                        <p className=\"text-muted\">Sign In to your account</p>\n                        <InputGroup className=\"mb-3\">\n                          <InputGroupAddon addonType=\"prepend\">\n                            <InputGroupText>\n                              <i className=\"icon-user\"></i>\n                            </InputGroupText>\n                          </InputGroupAddon>\n                          <Input\n                            type=\"email\"\n                            name=\"email\"\n                            placeholder=\"Username\"\n                            autoComplete=\"email\"\n                            required\n                            onChange={this.onChangeHandler}\n                          />\n                        </InputGroup>\n                        <InputGroup className=\"mb-4\">\n                          <InputGroupAddon addonType=\"prepend\">\n                            <InputGroupText>\n                              <i className=\"icon-lock\"></i>\n                            </InputGroupText>\n                          </InputGroupAddon>\n                          <Input\n                            type=\"password\"\n                            name=\"password\"\n                            id=\"passwordInput\"\n                            required\n                            placeholder=\"Password\"\n                            autoComplete=\"current-password\"\n                            onChange={this.onChangeHandler}\n                          />\n                        </InputGroup>\n                        <Alert\n                          id=\"alert\"\n                          isOpen={this.state.response}\n                          className=\"mt-2 font-weight-light\"\n                          color=\"danger\"\n                        >\n                          {this.state.response\n                            ? this.state.response.message\n                            : 'hidden'}\n                        </Alert>\n                        <Row>\n                          <Col xs=\"6\">\n                            <Button\n                              type=\"submit\"\n                              color=\"primary\"\n                              className=\"px-4\"\n                            >\n                              Login\n                            </Button>\n                          </Col>\n                          <Col xs=\"6\" className=\"text-right\">\n                            <Button color=\"link\" className=\"px-0\">\n                              Forgot password?\n                            </Button>\n                          </Col>\n                        </Row>\n                      </Form>\n                    </LoadingOverlay>\n                  </CardBody>\n                </Card>\n                <Card\n                  className=\"text-white bg-primary py-5 d-md-down-none\"\n                  style={{ width: '44%' }}\n                >\n                  <CardBody className=\"text-center\">\n                    <div>\n                      <h2>Sign up</h2>\n                      <p>\n                        Lorem ipsum dolor sit amet, consectetur adipisicing\n                        elit, sed do eiusmod tempor incididunt ut labore et\n                        dolore magna aliqua.\n                      </p>\n                      <Link>\n                        <Button\n                          color=\"primary\"\n                          className=\"mt-3\"\n                          active\n                          tabIndex={-1}\n                        >\n                          Register Now!\n                        </Button>\n                      </Link>\n                    </div>\n                  </CardBody>\n                </Card>\n              </CardGroup>\n            </Col>\n          </Row>\n        </Container>\n      </div>\n    );\n  }\n}\n\nexport default Login;\n"]},"metadata":{},"sourceType":"module"}