{"ast":null,"code":"import\"antd/es/row/style\";import _Row from\"antd/es/row\";import\"antd/es/radio/style\";import _Radio from\"antd/es/radio\";import _objectSpread from\"/Users/trongledo/Documents/GitHub/tutor-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import\"antd/es/button/style\";import _Button from\"antd/es/button\";import\"antd/es/tag/style\";import _Tag from\"antd/es/tag\";import _regeneratorRuntime from\"/Users/trongledo/Documents/GitHub/tutor-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _classCallCheck from\"/Users/trongledo/Documents/GitHub/tutor-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/trongledo/Documents/GitHub/tutor-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/trongledo/Documents/GitHub/tutor-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/trongledo/Documents/GitHub/tutor-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/trongledo/Documents/GitHub/tutor-admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import{MDBDataTable}from'mdbreact';import{Card,CardBody,CardHeader,Col}from'reactstrap';import LoadingOverlay from'react-loading-overlay';import AddModal from'./AddModal';import EditModal from'./EditModal';import DeleteModal from'./DeleteModal';var Accounts=/*#__PURE__*/function(_Component){_inherits(Accounts,_Component);function Accounts(props){var _this;_classCallCheck(this,Accounts);_this=_possibleConstructorReturn(this,_getPrototypeOf(Accounts).call(this,props));_this.componentWillMount=function _callee(){var token;return _regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:// const token = localStorage.removeItem(\"token\");\ntoken=JSON.parse(localStorage.getItem('token'));if(token){_this.setState({token:token});}else{_this.props.history.push('/login');}case 2:case\"end\":return _context.stop();}}});};_this.getBadge=function(status){return status==='active'?'success':status==='inactive'?'secondary':status==='pending'?'warning':status==='banned'?'danger':'primary';};_this.getUsers=function _callee2(){var requestOptions,response,userData;return _regeneratorRuntime.async(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_this.setState({loading:true});requestOptions={method:'GET',headers:{'Content-Type':'application/json',Authorization:\"Bearer \".concat(_this.state.token)}};_context2.prev=2;_context2.next=5;return _regeneratorRuntime.awrap(fetch('https://cors-anywhere.herokuapp.com/https://admin-api-tutor.herokuapp.com/me/admin',requestOptions));case 5:response=_context2.sent;_context2.next=8;return _regeneratorRuntime.awrap(_this.handleResponse(response));case 8:userData=_context2.sent;if(_this.state.roleFilter!=='all'){userData=userData.filter(function(data){return data.role===_this.state.roleFilter;});}userData.forEach(function(element,index){var date=new Date(element.date);element.index=index+1;element.date=date.toLocaleDateString();element.roleTag=element.role==='master'?React.createElement(_Tag,{color:\"magenta\"},element.role):React.createElement(_Tag,{color:\"geekblue\"},element.role);element.profile=React.createElement(\"img\",{src:element.picture,style:{height:50,width:50,objectFit:'cover',borderRadius:25},alt:\"profile\"});element.actions=React.createElement(\"div\",{className:\"float-right\"},React.createElement(_Button,{className:\"mr-2\",onClick:function onClick(){return _this.toggleEditModal(element);},type:\"primary\",icon:\"edit\"},\"Edit\"),React.createElement(_Button,{onClick:function onClick(){return _this.toggleDeleteModal(element);},type:\"danger\",icon:\"delete\"},\"Delete\"));});_this.setState({loading:false,userData:userData});return _context2.abrupt(\"return\",userData);case 15:_context2.prev=15;_context2.t0=_context2[\"catch\"](2);return _context2.abrupt(\"return\",_context2.t0);case 18:case\"end\":return _context2.stop();}}},null,null,[[2,15]]);};_this.handleCancel=function(){_this.setState({modalVisible:false,editModalVisible:false,deleteModalVisible:false});};_this.handleSubmit=function(){_this.setState({modalVisible:false,editModalVisible:false,deleteModalVisible:false});_this.getUsers();};_this.state={token:null,loading:true,modalVisible:false,editModalVisible:false,deleteModalVisible:false,currentUser:null,role:'admin',userData:[],modal:null,roleFilter:'all',columns:[{label:'ID',field:'index',sort:'asc',width:50},{label:'Picture',field:'profile',sort:'asc',width:100},{label:'Name',field:'name',sort:'asc',width:150},{label:'Email',field:'email',sort:'asc',width:150},{label:'Registered',field:'date',sort:'asc',width:100},{label:'Role',field:'roleTag',sort:'asc',width:100},{label:'Address',field:'address',sort:'asc',width:100},{label:'Actions',field:'actions',sort:'asc',width:100}]};return _this;}_createClass(Accounts,[{key:\"componentDidMount\",value:function componentDidMount(){this.getUsers();}},{key:\"handleResponse\",value:function handleResponse(response){return response.text().then(function(text){var data=text&&JSON.parse(text);if(!response.ok){if(response.status===401){}// auto logout if 401 response returned from api\n// logoutUser();\n// const error = (data && data.message) || response.statusText;\n// return Promise.reject(error);\nreturn data;}return data;});}},{key:\"onChangeRoleFilter\",value:function onChangeRoleFilter(e){this.setState({roleFilter:e.target.value});this.getUsers();}},{key:\"toggleModal\",value:function toggleModal(){this.setState({modalVisible:true});}},{key:\"toggleEditModal\",value:function toggleEditModal(user){this.setState({editModalVisible:true,currentUser:user});}},{key:\"toggleDeleteModal\",value:function toggleDeleteModal(user){this.setState({deleteModalVisible:true,currentUser:user});}},{key:\"onSubmit\",value:function onSubmit(){this.setState({modalVisible:false});}},{key:\"render\",value:function render(){var _this2=this;return React.createElement(\"div\",{className:\"animated fadeIn\"},React.createElement(LoadingOverlay,{active:this.state.loading,spinner:true,text:\"Loading...\",styles:{overlay:function overlay(base){return _objectSpread({},base,{background:'rgba(255, 255, 255, 0.5)',color:'black'});},spinner:function spinner(base){return _objectSpread({},base,{width:'100px','& svg circle':{stroke:'rgba(255, 0, 0, 0.5)'}});}}},React.createElement(_Row,null,React.createElement(Col,{xl:12},React.createElement(Card,null,React.createElement(CardHeader,{className:\"bg-dark\"},React.createElement(\"i\",{className:\"fa fa-align-justify\"}),\"Accounts\",'  ',React.createElement(\"small\",{className:\"text-muted\"},\"staff accounts\")),React.createElement(CardBody,null,React.createElement(AddModal,{handleCancel:this.handleCancel,handleSubmit:this.handleSubmit,modalVisible:this.state.modalVisible}),this.state.editModalVisible?React.createElement(EditModal,{handleCancel:this.handleCancel,handleSubmit:this.handleSubmit,modalVisible:this.state.editModalVisible,currentUser:this.state.currentUser}):null,this.state.deleteModalVisible?React.createElement(DeleteModal,{handleCancel:this.handleCancel,handleSubmit:this.handleSubmit,modalVisible:this.state.deleteModalVisible,currentUser:this.state.currentUser}):null,React.createElement(_Row,{className:\"mt-2\",type:\"flex\",justify:\"end\"},React.createElement(_Radio.Group,{defaultValue:\"a\",size:\"small\",buttonStyle:\"solid\",onChange:function onChange(e){return _this2.onChangeRoleFilter(e);},value:this.state.roleFilter,className:\"mr-4\"},React.createElement(_Radio.Button,{value:\"all\"},\"All\"),React.createElement(_Radio.Button,{value:\"master\"},\"Master\"),React.createElement(_Radio.Button,{value:\"admin\"},\"Admin\")),React.createElement(_Button,{type:\"primary\",icon:\"user-add\",style:{backgroundColor:'#00d77d',borderColor:'#00d77d'},onClick:function onClick(){return _this2.toggleModal();}},\"Create\")),React.createElement(MDBDataTable,{responsive:true,hover:true,bordered:true,data:{columns:this.state.columns,rows:this.state.userData}})))))));}}]);return Accounts;}(Component);export default Accounts;","map":{"version":3,"sources":["/Users/trongledo/Documents/GitHub/tutor-admin/src/views/Accounts/Accounts.js"],"names":["React","Component","MDBDataTable","Card","CardBody","CardHeader","Col","LoadingOverlay","AddModal","EditModal","DeleteModal","Accounts","props","componentWillMount","token","JSON","parse","localStorage","getItem","setState","history","push","getBadge","status","getUsers","loading","requestOptions","method","headers","Authorization","state","fetch","response","handleResponse","userData","roleFilter","filter","data","role","forEach","element","index","date","Date","toLocaleDateString","roleTag","profile","picture","height","width","objectFit","borderRadius","actions","toggleEditModal","toggleDeleteModal","handleCancel","modalVisible","editModalVisible","deleteModalVisible","handleSubmit","currentUser","modal","columns","label","field","sort","text","then","ok","e","target","value","user","overlay","base","background","color","spinner","stroke","onChangeRoleFilter","backgroundColor","borderColor","toggleModal","rows"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { MDBDataTable } from 'mdbreact';\nimport { Card, CardBody, CardHeader, Col } from 'reactstrap';\nimport LoadingOverlay from 'react-loading-overlay';\nimport { Radio, Row, Typography, Button, Tag, Select } from 'antd';\nimport AddModal from './AddModal';\nimport EditModal from './EditModal';\nimport DeleteModal from './DeleteModal';\n\nclass Accounts extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      token: null,\n      loading: true,\n      modalVisible: false,\n      editModalVisible: false,\n      deleteModalVisible: false,\n      currentUser: null,\n      role: 'admin',\n      userData: [],\n      modal: null,\n      roleFilter: 'all',\n      columns: [\n        {\n          label: 'ID',\n          field: 'index',\n          sort: 'asc',\n          width: 50\n        },\n        {\n          label: 'Picture',\n          field: 'profile',\n          sort: 'asc',\n          width: 100\n        },\n        {\n          label: 'Name',\n          field: 'name',\n          sort: 'asc',\n          width: 150\n        },\n        {\n          label: 'Email',\n          field: 'email',\n          sort: 'asc',\n          width: 150\n        },\n        {\n          label: 'Registered',\n          field: 'date',\n          sort: 'asc',\n          width: 100\n        },\n        {\n          label: 'Role',\n          field: 'roleTag',\n          sort: 'asc',\n          width: 100\n        },\n        {\n          label: 'Address',\n          field: 'address',\n          sort: 'asc',\n          width: 100\n        },\n        {\n          label: 'Actions',\n          field: 'actions',\n          sort: 'asc',\n          width: 100\n        }\n      ]\n    };\n  }\n\n  componentWillMount = async () => {\n    // const token = localStorage.removeItem(\"token\");\n    const token = JSON.parse(localStorage.getItem('token'));\n\n    if (token) {\n      this.setState({ token });\n    } else {\n      this.props.history.push('/login');\n    }\n  };\n\n  componentDidMount() {\n    this.getUsers();\n  }\n\n  getBadge = status => {\n    return status === 'active'\n      ? 'success'\n      : status === 'inactive'\n      ? 'secondary'\n      : status === 'pending'\n      ? 'warning'\n      : status === 'banned'\n      ? 'danger'\n      : 'primary';\n  };\n\n  getUsers = async () => {\n    this.setState({ loading: true });\n    const requestOptions = {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: `Bearer ${this.state.token}`\n      }\n    };\n    try {\n      const response = await fetch(\n        'https://cors-anywhere.herokuapp.com/https://admin-api-tutor.herokuapp.com/me/admin',\n        requestOptions\n      );\n\n      let userData = await this.handleResponse(response);\n\n      if (this.state.roleFilter !== 'all') {\n        userData = userData.filter(data => data.role === this.state.roleFilter);\n      }\n\n      userData.forEach((element, index) => {\n        let date = new Date(element.date);\n        element.index = index + 1;\n        element.date = date.toLocaleDateString();\n        element.roleTag =\n          element.role === 'master' ? (\n            <Tag color=\"magenta\">{element.role}</Tag>\n          ) : (\n            <Tag color=\"geekblue\">{element.role}</Tag>\n          );\n        element.profile = (\n          <img\n            src={element.picture}\n            style={{\n              height: 50,\n              width: 50,\n              objectFit: 'cover',\n              borderRadius: 25\n            }}\n            alt=\"profile\"\n          />\n        );\n        element.actions = (\n          <div className=\"float-right\">\n            <Button\n              className=\"mr-2\"\n              onClick={() => this.toggleEditModal(element)}\n              type=\"primary\"\n              icon=\"edit\"\n            >\n              Edit\n            </Button>\n            <Button\n              onClick={() => this.toggleDeleteModal(element)}\n              type=\"danger\"\n              icon=\"delete\"\n            >\n              Delete\n            </Button>\n          </div>\n        );\n      });\n\n      this.setState({ loading: false, userData: userData });\n      return userData;\n    } catch (err) {\n      return err;\n    }\n  };\n\n  handleResponse(response) {\n    return response.text().then(text => {\n      const data = text && JSON.parse(text);\n      if (!response.ok) {\n        if (response.status === 401) {\n          // auto logout if 401 response returned from api\n          // logoutUser();\n        }\n\n        // const error = (data && data.message) || response.statusText;\n        // return Promise.reject(error);\n        return data;\n      }\n      return data;\n    });\n  }\n\n  onChangeRoleFilter(e) {\n    this.setState({ roleFilter: e.target.value });\n    this.getUsers();\n  }\n\n  handleCancel = () => {\n    this.setState({\n      modalVisible: false,\n      editModalVisible: false,\n      deleteModalVisible: false\n    });\n  };\n\n  handleSubmit = () => {\n    this.setState({\n      modalVisible: false,\n      editModalVisible: false,\n      deleteModalVisible: false\n    });\n    this.getUsers();\n  };\n\n  toggleModal() {\n    this.setState({ modalVisible: true });\n  }\n\n  toggleEditModal(user) {\n    this.setState({ editModalVisible: true, currentUser: user });\n  }\n\n  toggleDeleteModal(user) {\n    this.setState({ deleteModalVisible: true, currentUser: user });\n  }\n\n  onSubmit() {\n    this.setState({ modalVisible: false });\n  }\n\n  render() {\n    return (\n      <div className=\"animated fadeIn\">\n        <LoadingOverlay\n          active={this.state.loading}\n          spinner\n          text=\"Loading...\"\n          styles={{\n            overlay: base => ({\n              ...base,\n              background: 'rgba(255, 255, 255, 0.5)',\n              color: 'black'\n            }),\n            spinner: base => ({\n              ...base,\n              width: '100px',\n              '& svg circle': {\n                stroke: 'rgba(255, 0, 0, 0.5)'\n              }\n            })\n          }}\n        >\n          <Row>\n            <Col xl={12}>\n              <Card>\n                <CardHeader className=\"bg-dark\">\n                  <i className=\"fa fa-align-justify\"></i>Accounts{'  '}\n                  <small className=\"text-muted\">staff accounts</small>\n                </CardHeader>\n                <CardBody>\n                  <AddModal\n                    handleCancel={this.handleCancel}\n                    handleSubmit={this.handleSubmit}\n                    modalVisible={this.state.modalVisible}\n                  ></AddModal>\n                  {this.state.editModalVisible ? (\n                    <EditModal\n                      handleCancel={this.handleCancel}\n                      handleSubmit={this.handleSubmit}\n                      modalVisible={this.state.editModalVisible}\n                      currentUser={this.state.currentUser}\n                    ></EditModal>\n                  ) : null}\n                  {this.state.deleteModalVisible ? (\n                    <DeleteModal\n                      handleCancel={this.handleCancel}\n                      handleSubmit={this.handleSubmit}\n                      modalVisible={this.state.deleteModalVisible}\n                      currentUser={this.state.currentUser}\n                    ></DeleteModal>\n                  ) : null}\n                  <Row className=\"mt-2\" type=\"flex\" justify=\"end\">\n                    <Radio.Group\n                      defaultValue=\"a\"\n                      size=\"small\"\n                      buttonStyle=\"solid\"\n                      onChange={e => this.onChangeRoleFilter(e)}\n                      value={this.state.roleFilter}\n                      className=\"mr-4\"\n                    >\n                      <Radio.Button value=\"all\">All</Radio.Button>\n                      <Radio.Button value=\"master\">Master</Radio.Button>\n                      <Radio.Button value=\"admin\">Admin</Radio.Button>\n                    </Radio.Group>\n                    <Button\n                      type=\"primary\"\n                      icon=\"user-add\"\n                      style={{\n                        backgroundColor: '#00d77d',\n                        borderColor: '#00d77d'\n                      }}\n                      onClick={() => this.toggleModal()}\n                    >\n                      Create\n                    </Button>\n                  </Row>\n                  <MDBDataTable\n                    responsive\n                    hover\n                    bordered\n                    data={{\n                      columns: this.state.columns,\n                      rows: this.state.userData\n                    }}\n                  />\n                </CardBody>\n              </Card>\n            </Col>\n          </Row>\n        </LoadingOverlay>\n      </div>\n    );\n  }\n}\n\nexport default Accounts;\n"]},"metadata":{},"sourceType":"module"}